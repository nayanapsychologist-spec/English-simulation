<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Activity: Put the Story in Order</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        .drag-item {
            cursor: grab;
            transition: all 0.2s ease;
            user-select: none;
        }
        .drag-item:active {
            cursor: grabbing;
        }
        .sortable-ghost {
            opacity: 0.4;
            background-color: #f3f4f6;
            border: 2px dashed #9ca3af;
        }
        .correct-glow {
            box-shadow: 0 0 15px rgba(34, 197, 94, 0.5);
            border-color: #22c55e !important;
        }
        .wrong-glow {
            box-shadow: 0 0 15px rgba(239, 68, 68, 0.5);
            border-color: #ef4444 !important;
        }
    </style>
</head>
<body class="bg-orange-50 min-h-screen font-sans text-gray-800 p-4 md:p-8">

    <div class="max-w-3xl mx-auto bg-white rounded-2xl shadow-xl overflow-hidden border border-orange-100">
        <!-- Header -->
        <div class="bg-orange-500 p-6 text-white text-center">
            <h1 class="text-3xl font-bold mb-2">The Legend of Maruti</h1>
            <p class="text-orange-100 italic">Read the sentences below. They are all mixed up! Put them in the correct order by dragging them up or down.</p>
        </div>

        <!-- Activity Area -->
        <div class="p-6">
            <div id="story-list" class="space-y-3">
                <!-- Items will be injected here -->
            </div>

            <!-- Controls -->
            <div class="mt-8 flex flex-col sm:flex-row items-center justify-between gap-4 border-t pt-6">
                <button id="check-btn" class="w-full sm:w-auto px-8 py-3 bg-orange-600 hover:bg-orange-700 text-white font-bold rounded-full transition-transform active:scale-95 shadow-lg">
                    Check My Answer
                </button>
                <button id="reset-btn" class="w-full sm:w-auto px-8 py-3 bg-gray-200 hover:bg-gray-300 text-gray-700 font-bold rounded-full transition-transform active:scale-95">
                    Reset
                </button>
            </div>

            <!-- Feedback Message -->
            <div id="feedback" class="mt-6 text-center text-lg font-semibold hidden"></div>
        </div>
    </div>

    <!-- Teacher Key Modal -->
    <div id="modal-overlay" class="fixed inset-0 bg-black bg-opacity-50 hidden flex items-center justify-center p-4">
        <div class="bg-white rounded-lg p-6 max-w-md w-full shadow-2xl">
            <h2 class="text-xl font-bold mb-4 text-orange-600 border-bottom pb-2">Answer Key (For Teachers)</h2>
            <ol class="list-decimal list-inside space-y-2 text-sm text-gray-700">
                <li>Anjana and Kesari have a brave and strong son named Maruti.</li>
                <li>Little Maruti wakes up feeling very hungry and looks for food.</li>
                <li>He sees the big, red Sun and thinks it is a delicious, ripe fruit.</li>
                <li>Hanuman flies high into the sky to catch the glowing "fruit."</li>
                <li>As Hanuman gets closer, the Sun starts to feel very hot.</li>
                <li>The Sun God gets scared and calls Lord Indra for help.</li>
            </ol>
            <button id="close-modal" class="mt-6 w-full py-2 bg-gray-800 text-white rounded">Close</button>
        </div>
    </div>

    <div class="text-center mt-6 text-gray-500 text-sm">
        <button id="show-key" class="underline hover:text-orange-600">Show Teacher Answer Key</button>
    </div>

    <!-- Drag and Drop Library -->
    <script src="https://cdn.jsdelivr.net/npm/sortablejs@1.15.0/Sortable.min.js"></script>

    <script>
        const correctOrder = [
            "Anjana and Kesari have a brave and strong son named Maruti.",
            "Little Maruti wakes up feeling very hungry and looks for food.",
            "He sees the big, red Sun and thinks it is a delicious, ripe fruit.",
            "Hanuman flies high into the sky to catch the glowing \"fruit.\"",
            "As Hanuman gets closer, the Sun starts to feel very hot.",
            "The Sun God gets scared and calls Lord Indra for help."
        ];

        // Shuffle function
        function shuffle(array) {
            let currentIndex = array.length, randomIndex;
            while (currentIndex != 0) {
                randomIndex = Math.floor(Math.random() * currentIndex);
                currentIndex--;
                [array[currentIndex], array[randomIndex]] = [array[randomIndex], array[currentIndex]];
            }
            return array;
        }

        const listElement = document.getElementById('story-list');
        const checkBtn = document.getElementById('check-btn');
        const resetBtn = document.getElementById('reset-btn');
        const feedback = document.getElementById('feedback');
        const modal = document.getElementById('modal-overlay');

        function initApp() {
            const shuffled = shuffle([...correctOrder]);
            listElement.innerHTML = '';
            
            shuffled.forEach((text, index) => {
                const item = document.createElement('div');
                item.className = 'drag-item p-4 bg-white border-2 border-orange-100 rounded-xl flex items-center gap-4 shadow-sm hover:border-orange-300';
                item.dataset.text = text;
                item.innerHTML = `
                    <div class="flex-shrink-0 w-8 h-8 bg-orange-100 text-orange-600 rounded-full flex items-center justify-center font-bold">
                        ?
                    </div>
                    <p class="flex-grow text-gray-700 leading-relaxed">${text}</p>
                    <div class="text-gray-300">
                        <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 8h16M4 16h16" />
                        </svg>
                    </div>
                `;
                listElement.appendChild(item);
            });

            new Sortable(listElement, {
                animation: 150,
                ghostClass: 'sortable-ghost',
                onStart: () => {
                    feedback.classList.add('hidden');
                    clearStyles();
                }
            });
        }

        function clearStyles() {
            document.querySelectorAll('.drag-item').forEach(el => {
                el.classList.remove('correct-glow', 'wrong-glow', 'bg-green-50', 'bg-red-50');
                el.querySelector('div').className = 'flex-shrink-0 w-8 h-8 bg-orange-100 text-orange-600 rounded-full flex items-center justify-center font-bold';
                el.querySelector('div').innerText = '?';
            });
        }

        checkBtn.onclick = () => {
            const currentItems = Array.from(listElement.children);
            let score = 0;

            currentItems.forEach((item, index) => {
                const itemText = item.dataset.text;
                const circle = item.querySelector('div');
                
                if (itemText === correctOrder[index]) {
                    score++;
                    item.classList.add('correct-glow', 'bg-green-50');
                    circle.className = 'flex-shrink-0 w-8 h-8 bg-green-500 text-white rounded-full flex items-center justify-center font-bold';
                    circle.innerText = index + 1;
                } else {
                    item.classList.add('wrong-glow', 'bg-red-50');
                    circle.className = 'flex-shrink-0 w-8 h-8 bg-red-500 text-white rounded-full flex items-center justify-center font-bold';
                    circle.innerText = '!';
                }
            });

            feedback.classList.remove('hidden');
            if (score === correctOrder.length) {
                feedback.innerHTML = `<span class="text-green-600">ðŸŽ‰ Excellent! You put the story in the perfect order!</span>`;
            } else {
                feedback.innerHTML = `<span class="text-red-600">You got ${score} out of ${correctOrder.length} correct. Try moving the red items!</span>`;
            }
        };

        resetBtn.onclick = () => {
            feedback.classList.add('hidden');
            initApp();
        };

        document.getElementById('show-key').onclick = () => modal.classList.remove('hidden');
        document.getElementById('close-modal').onclick = () => modal.classList.add('hidden');

        // Initialize on load
        window.onload = initApp;
    </script>
</body>
</html>
